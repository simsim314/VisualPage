<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="stuff, to, help, search, engines, not" name="keywords">
<meta content="What this page is about." name="description">
<meta content="Display Webcam Stream" name="title">
<title>Display Webcam Stream</title>
</head>
  
<body>
<p id="p12">X1</p>
  
<p id="p1">_</p>
    <video autoplay="true" id="videoElement" style="display: none;"></video>
    <canvas id="canvas" onclick= canvasOnclick()></canvas>

<script>
var video = document.querySelector("#videoElement");
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
if (navigator.mediaDevices.getUserMedia) {       
    navigator.mediaDevices.getUserMedia({video: true})
  .then(function(stream) {
    video.srcObject = stream;
  })
  .catch(function(err0r) {
    console.log("Something went wrong!");
  });
}



var myVar = setInterval(intervalTimer, 10);

function intervalTimer() {
  ctx.drawImage(video,0,0,100,100);
  var data = ctx.getImageData(0, 0, 100, 100).data;
  
  var total = 0; 
  
  for(var i = 0; i < 30000; i+= 100)
    total += data[i];
  
  total /= 300;
  
  state = "1" 
  if(total < 20)
  {
    state = "0";
  }
  
  if(document.getElementById("p1").innerHTML != state)
    document.getElementById("p1").innerHTML = state
   
  if(state == "1")
    document.body.style.background = "white";
  else
   document.body.style.background = "black";
 
}

//var data = ctx.getImageData(0, 0, w, h).data;
</script>
</body>
</html>
